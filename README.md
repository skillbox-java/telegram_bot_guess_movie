# GuessMovieBot

## О проекте

GuessMovieBot — это интерактивный Telegram бот для игры в "Угадай фильм". Бот показывает пользователю изображение, связанное с фильмом, и предлагает несколько вариантов названий фильмов на выбор. Задача игрока — выбрать правильное название фильма по изображению. За каждый правильный ответ игрок получает очко.

Особенности бота:
- Случайный выбор фильмов из предварительно подготовленного списка
- Интерактивная клавиатура с вариантами ответов
- Подсчет очков и отслеживание прогресса игрока
- Мгновенная обратная связь о правильности ответа

## Технологии

Проект использует следующие технологии и библиотеки:

- **Java** — основной язык программирования
- **Telegram Bot API** — для создания и управления ботом в Telegram
  - telegrambots-longpolling — для получения обновлений от API Telegram
  - telegrambots-client — для отправки запросов к API Telegram
- **Apache Commons CSV** — для обработки CSV-файлов с данными о фильмах
- **Gradle** — система сборки проекта
- **JUnit** — фреймворк для тестирования

## Архитектура проекта

Проект имеет следующую структуру:

- **bot** — классы для работы с Telegram API
  - `GuessMovieBot.java` — основной класс бота, обрабатывающий сообщения
  - `KeyboardBuilder.java` — класс для создания клавиатуры с вариантами ответов
- **config** — конфигурация и чтение параметров окружения
  - `Config.java` — хранит конфигурационные параметры
  - `ConfigReader.java` — интерфейс для чтения конфигурации
  - `ConfigReaderEnvironment.java` — реализация чтения конфигурации из переменных окружения
- **game** — логика игрового процесса
  - `GameManager.java` — управление игровыми сессиями
  - `GameSession.java` — состояние конкретной игровой сессии
  - `Movie.java` — модель данных фильма
  - `Question.java` — вопрос игры с правильным ответом и вариантами
- **parser** — обработка данных
  - `MovieParser.java` — парсинг фильмов из CSV-файла

## Как запустить

### Предварительные требования

1. JDK 17 или выше
2. Gradle
3. Токен Telegram бота (получается через [@BotFather](https://t.me/BotFather))

### Готовые данные

В проект уже включен пример файла `movies.csv` со списком фильмов и соответствующие изображения. Вы можете использовать эти готовые данные для тестирования работы бота или добавить свои фильмы, следуя такому же формату.

### Запуск бота

1. Соберите проект с помощью Gradle:
   ```
   ./gradlew build
   ```

2. Запустите бот, передав токен через переменную окружения:
   ```
   export BOT_TOKEN=ваш_телеграм_токен
   ./gradlew run
   ```

   Альтернативно, можно запустить JAR-файл напрямую:
   ```
   export BOT_TOKEN=ваш_телеграм_токен
   java -jar build/libs/EchoBot-1.0-SNAPSHOT.jar
   ```

### Использование бота

1. Найдите вашего бота в Telegram по его имени
2. Отправьте команду `/start` для начала игры
3. Бот отправит изображение и варианты названий фильмов
4. Выберите правильный вариант ответа из предложенных на клавиатуре
5. За каждый правильный ответ получайте очки
6. Игра заканчивается, когда заканчиваются вопросы

## Структура данных в проекте

В проект уже включен файл `movies.csv`, который находится в директории `src/main/resources/`. Этот файл содержит информацию о фильмах в формате:

```csv
Название,ПутьКИзображению
```

Изображения фильмов также уже включены в проект и размещены в соответствии с путями, указанными в CSV-файле.

Вы можете расширить список фильмов, добавив новые строки в CSV-файл и соответствующие изображения в ресурсы проекта.

## Дополнительные настройки

Вы можете изменить следующие параметры игры, отредактировав соответствующие константы в коде:

- `GameSession.ANSWER_OPTIONS_AMOUNT` — количество вариантов ответа (по умолчанию 5)
- `GuessMovieBot.ANSWER_COLUMNS_COUNT` — количество колонок в клавиатуре ответов (по умолчанию 3)
